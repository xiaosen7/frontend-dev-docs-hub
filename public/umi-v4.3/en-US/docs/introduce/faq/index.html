<!DOCTYPE html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta property="og:image" content="https://umijs.org/images/og-home.png">
<meta property="og:url" content="https://umijs.org/">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Umi">
<meta property="og:description" content="Umi是可扩展的企业级前端应用框架。Umi 以路由为基础的，同时支持配置式路由和约定式路由，保证路由的功能完备，并以此进行功能扩展。然后配以生命周期完善的插件体系，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求。">
<meta property="twitter:image" content="https://umijs.org/images/og-home.png">
<meta property="twitter:site" content="https://umijs.org/">
<meta property="twitter:creator" content="Umi">
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:title" content="Umi">
<meta property="twitter:description" content="Umi是可扩展的企业级前端应用框架。Umi 以路由为基础的，同时支持配置式路由和约定式路由，保证路由的功能完备，并以此进行功能扩展。然后配以生命周期完善的插件体系，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求。">
<meta property="fb:app_id" content="922985738798968">
<link rel="shortcut icon" href="https://img.alicdn.com/tfs/TB1YHEpwUT1gK0jSZFhXXaAtVXa-28-27.svg">
<link rel="stylesheet" href="/umi.c9f82ed3.css">
<title data-rh="true">FAQ</title>
<meta data-rh="true" property="og:title" content="FAQ"/><meta data-rh="true" name="description" content="Yes, but it is not recommended to do so."/><meta data-rh="true" property="og:description" content="Yes, but it is not recommended to do so."/>
<link data-rh="true" rel="canonical" href="https://umijs.org//en-US/docs/introduce/faq"/>
</head>
<body>
<noscript><b>Enable JavaScript to run this app.</b></noscript><div id="root"><!--$?--><template id="B:0"></template><div></div><!--/$--></div><script>window.__UMI_LOADER_DATA__ = {}</script>
<script async="" src="/umi.0bdf4102.js"></script>

</body></html><div hidden id="S:0"><!--$?--><template id="B:1"></template><div></div><!--/$--></div><script>function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("B:0","S:0")</script><div hidden id="S:1"><div class="dumi-default-doc-layout"><div class="dumi-default-header"><div class="dumi-default-header-content"><section class="dumi-default-header-left"><a class="dumi-default-logo" href="/en-US"><img src="https://gw.alipayobjects.com/zos/bmw-prod/598d14af-4f1c-497d-b579-5ac42cd4dd1f/k7bjua9c_w132_h130.png" alt="UmiJS"/>UmiJS<!-- --></a></section><section class="dumi-default-header-right"><ul class="dumi-default-navbar"><li><a class="active" href="/en-US/docs/introduce/introduce">Introduce</a></li><li><a href="/en-US/docs/guides/getting-started">Guide</a></li><li><a href="/en-US/docs/api/api">API</a></li><li><a href="/en-US/docs/max/introduce">Umi Max</a></li><li><a href="/en-US/blog/umi-4-rc">Blog</a></li></ul><div class="dumi-default-header-right-aside"><div class="dumi-default-search-bar"><svg viewBox="64 64 896 896" class="dumi-default-search-bar-svg"><path d="M909.6 854.5 649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg><input class="dumi-default-search-bar-input" placeholder="Type keywords..."/><span class="dumi-default-search-shortcut">⌘<!-- --> K<!-- --></span></div><a class="dumi-default-lang-switch" href="/docs/introduce/faq">中文</a><span class="dumi-default-color-switch" data-dumi-tooltip="Light Mode" data-dumi-tooltip-bottom="true"><svg viewBox="0 0 16 16"><path d="M8 13a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0v-1a1 1 0 0 1 1-1ZM8 3a1 1 0 0 1-1-1V1a1 1 0 1 1 2 0v1a1 1 0 0 1-1 1Zm7 4a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2h1ZM3 8a1 1 0 0 1-1 1H1a1 1 0 1 1 0-2h1a1 1 0 0 1 1 1Zm9.95 3.536.707.707a1 1 0 0 1-1.414 1.414l-.707-.707a1 1 0 0 1 1.414-1.414Zm-9.9-7.072-.707-.707a1 1 0 0 1 1.414-1.414l.707.707A1 1 0 0 1 3.05 4.464Zm9.9 0a1 1 0 0 1-1.414-1.414l.707-.707a1 1 0 0 1 1.414 1.414l-.707.707Zm-9.9 7.072a1 1 0 0 1 1.414 1.414l-.707.707a1 1 0 0 1-1.414-1.414l.707-.707ZM8 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm0 6.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5Z"></path></svg><select><option value="light" selected="">Light Mode<!-- --></option><option value="dark">Dark Mode<!-- --></option><option value="auto">Follow System<!-- --></option></select></span><a class="dumi-default-icon" data-dumi-tooltip="GitHub" data-dumi-tooltip-bottom="true" target="_blank" href="https://github.com/umijs/umi" rel="noreferrer"><svg viewBox="64 64 896 896"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><div class="dumi-default-lang-select" style="border-inline-start:1px solid #d0d5d8;margin-inline-start:15px;padding-inline-start:5px"><select style="padding-top:1px;padding-bottom:1px"><option value="4.3.31" selected="">4.3.31<!-- --></option><option value="3.x">3.x<!-- --></option></select><svg viewBox="64 64 896 896"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></div></div></section><button type="button" class="dumi-default-header-menu-btn"><svg viewBox="64 64 896 896"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></button></div></div><div class="dumi-default-doc-layout-mobile-bar"><button type="button" class="dumi-default-sidebar-btn"><svg viewBox="64 64 896 896"><path d="M120 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm0 424h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm784 140H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0-424H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"></path></svg>Sidebar<!-- --></button></div><main><div class="dumi-default-sidebar"><dl class="dumi-default-sidebar-group"><dd><a title="Introduction to Umi" class="" href="/en-US/docs/introduce/introduce">Introduction to Umi</a></dd><dd><a title="Design Philosophy" class="" href="/en-US/docs/introduce/philosophy">Design Philosophy</a></dd><dd><a title="Contributing" class="" href="/en-US/docs/introduce/contributing">Contributing</a></dd><dd><a title="Upgrade to Umi 4" class="" href="/en-US/docs/introduce/upgrade-to-umi-4">Upgrade to Umi 4</a></dd><dd><a title="FAQ" aria-current="page" class="active" href="/en-US/docs/introduce/faq">FAQ</a></dd></dl></div><div class="dumi-default-content"><article><!--$?--><template id="B:2"></template><div></div><!--/$--></article><footer class="dumi-default-content-footer"><dl><dd><svg viewBox="64 64 896 896"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"></path><path d="M686.7 638.6 544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"></path></svg>Last updated: <!-- --><time dateTime=""></time></dd></dl><nav></nav></footer><div class="dumi-default-footer">Open-source MIT Licensed | Copyright © 2017-present</div></div><div class="dumi-default-doc-layout-toc-wrapper"><h4>TABLE OF CONTENTS</h4></div></main></div></div><script>$RC("B:1","S:1")</script><div hidden id="S:2"><div class="markdown"><h1 id="faq"><a aria-hidden="true" tabindex="-1" href="#faq"><span class="icon icon-link"></span></a>FAQ<!-- --></h1><h2 id="can-i-disable-dynamicimport"><a aria-hidden="true" tabindex="-1" href="#can-i-disable-dynamicimport"><span class="icon icon-link"></span></a>Can I disable dynamicImport?<!-- --></h2><p>Yes, but it is not recommended to do so.</p><ol><li>Install dependencies</li></ol><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-bash"><div class=""><div class=""><span class="token function">pnpm</span><span class="token plain"> i babel-plugin-dynamic-import-node -D</span></div></div></pre></div><ol start="2"><li>Add <!-- --><code>extraBabelPlugins</code> to the configuration, but only enable it for production<!-- --></li></ol><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  extraBabelPlugins</span><span class="token operator">:</span><span class="token plain"> process</span><span class="token punctuation">.</span><span class="token plain">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&#x27;production&#x27;</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">    </span><span class="token operator">?</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;babel-plugin-dynamic-import-node&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">    </span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><h2 id="how-to-configure-loading-for-dynamicimport-when-its-not-present"><a aria-hidden="true" tabindex="-1" href="#how-to-configure-loading-for-dynamicimport-when-its-not-present"><span class="icon icon-link"></span></a>How to configure loading for dynamicImport when it&#x27;s not present?<!-- --></h2><p>Define <!-- --><code>src/loading.tsx</code>:<!-- --></p><p>See <!-- --><a href="/en-US/docs/guides/directory-structure#loadingtsxjsx">Directory Structure &gt; loading.tsx</a></p><h2 id="can-i-use-react-17"><a aria-hidden="true" tabindex="-1" href="#can-i-use-react-17"><span class="icon icon-link"></span></a>Can I use React 17?<!-- --></h2><p>Since Umi v4 has upgraded the default version of React to v18, be aware of compatibility between dependency libraries and React 18 when using Umi4. If you still need to use React 17, run the following commands and restart.</p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-bash"><div class=""><div class=""><span class="token function">pnpm</span><span class="token plain"> </span><span class="token function">add</span><span class="token plain"> react@^17 react-dom@^17</span></div></div></pre></div><h2 id="constantly-restarting-and-refreshing-the-page-after-proxying-static-resources-locally"><a aria-hidden="true" tabindex="-1" href="#constantly-restarting-and-refreshing-the-page-after-proxying-static-resources-locally"><span class="icon icon-link"></span></a>Constantly restarting and refreshing the page after proxying static resources locally<!-- --></h2><img src="/static/rstart.00c09aa7.png"/><p>Solution: Configure <!-- --><code>SOCKET_SERVER=127.0.0.1:${port}</code> to start the project<!-- --></p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-bash"><div class=""><div class=""><span class="token assign-left variable">SOCKET_SERVER</span><span class="token operator">=</span><span class="token plain">http://127.0.0.1:8000 </span><span class="token function">pnpm</span><span class="token plain"> dev</span></div></div></pre></div><h2 id="error-evaluating-function-round-argument-must-be-a-number"><a aria-hidden="true" tabindex="-1" href="#error-evaluating-function-round-argument-must-be-a-number"><span class="icon icon-link"></span></a>Error evaluating function <!-- --><code>round</code>: argument must be a number<!-- --></h2><img src="/static/less-error.c5d3d72b.png"/><p>Solution: In the new version of less, <!-- --><code>/</code> is recognized as property shorthand by default. To restore the old behavior (where <!-- --><code>/</code> was used as a calculation symbol by default), configure <!-- --><code>lessLoader: { math: &#x27;always&#x27; }</code>.<!-- --></p><h2 id="the-layout-configuration-option-in-routes-does-not-take-effect"><a aria-hidden="true" tabindex="-1" href="#the-layout-configuration-option-in-routes-does-not-take-effect"><span class="icon icon-link"></span></a>The layout configuration option in routes does not take effect<!-- --></h2><p>The layout configuration has been moved to <!-- --><code>app.ts</code>, see <!-- --><a href="https://umijs.org/docs/api/runtime-config#layout">Runtime Config &gt; layout</a></p><h2 id="where-did-documentejs-go-and-how-do-i-customize-the-html-template"><a aria-hidden="true" tabindex="-1" href="#where-did-documentejs-go-and-how-do-i-customize-the-html-template"><span class="icon icon-link"></span></a>Where did document.ejs go and how do I customize the HTML template<!-- --></h2><p>In addition to the injection through the configuration of external <!-- --><a href="https://umijs.org/docs/api/config#scripts">script</a>, <!-- --><a href="https://umijs.org/docs/api/config#styles">css</a>, you can also use the project-level plugin to more flexibly modify HTML products, see: <!-- --><a href="https://github.com/umijs/umi-next/issues/868#issuecomment-1151088426">issuecomment-1151088426</a></p><h2 id="why-are-external-js-files-configured-in-scripts-by-default-inserted-after-umijs"><a aria-hidden="true" tabindex="-1" href="#why-are-external-js-files-configured-in-scripts-by-default-inserted-after-umijs"><span class="icon icon-link"></span></a>Why are external js files configured in scripts by default inserted after umi.js<!-- --></h2><p>React only starts running after the page has fully loaded, so inserting after <!-- --><code>umi.js</code> will not affect the project.<!-- --></p><p>If you need to insert it before <!-- --><code>umi.js</code>, see <!-- --><a href="https://github.com/umijs/umi/issues/8442#issuecomment-1176960539">issuecomment-1176960539</a></p><h2 id="how-do-i-code-split-with-umi4"><a aria-hidden="true" tabindex="-1" href="#how-do-i-code-split-with-umi4"><span class="icon icon-link"></span></a>How do I code split with Umi4?<!-- --></h2><p>Umi 4 splits code by page by default. If you feel the need for further optimization, you can use sub-package strategies or manual splitting, see: <!-- --><a href="/en-US/blog/code-splitting">Code Splitting Guide</a></p><p>If you have the requirement to pack all js products into a single <!-- --><code>umi.js</code> file, please disable <!-- --><a href="/en-US/docs/introduce/faq#can-i-disable-dynamicimport">dynamicImport</a>.<!-- --></p><h2 id="where-did-_layouttsx-go-and-how-do-i-nest-routes"><a aria-hidden="true" tabindex="-1" href="#where-did-_layouttsx-go-and-how-do-i-nest-routes"><span class="icon icon-link"></span></a>Where did _layout.tsx go and how do I nest routes?<!-- --></h2><p>Umi 4 uses react-router v6, and nested route content is displayed through <!-- --><code>&lt;Outlet /&gt;</code>. See: <!-- --><a href="https://github.com/umijs/umi/issues/8850#issuecomment-1206194329">issuecomment-1206194329</a></p><h2 id="how-to-use-graphql"><a aria-hidden="true" tabindex="-1" href="#how-to-use-graphql"><span class="icon icon-link"></span></a>How to use GraphQL<!-- --></h2><p>For configuring <!-- --><code>graph-ql</code> loader, see: <!-- --><a href="https://github.com/umijs/umi/discussions/8218">discussions/8218</a></p><h2 id="how-to-use-webassembly"><a aria-hidden="true" tabindex="-1" href="#how-to-use-webassembly"><span class="icon icon-link"></span></a>How to use WebAssembly<!-- --></h2><p>Configure as follows:</p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">
</span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  </span><span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token plain">config</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">    config</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#x27;experiments&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token operator">...</span><span class="token plain">config</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#x27;experiments&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      asyncWebAssembly</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">
</span></div></div><div class=""><div class=""><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token constant">REG</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.wasm$</span><span class="token regex regex-delimiter">/</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">
</span></div></div><div class=""><div class=""><span class="token plain">    config</span><span class="token punctuation">.</span><span class="token plain">module</span><span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&#x27;asset&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token plain">exclude</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">REG</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">
</span></div></div><div class=""><div class=""><span class="token plain">    config</span><span class="token punctuation">.</span><span class="token plain">module</span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">&#x27;wasm&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token constant">REG</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token plain">exclude</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">node_modules</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&#x27;webassembly/async&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">      </span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><p>See an actual example: <!-- --><a href="https://github.com/umijs/umi/discussions/8541">discussions/8541</a></p><h2 id="how-to-customize-loaders"><a aria-hidden="true" tabindex="-1" href="#how-to-customize-loaders"><span class="icon icon-link"></span></a>How to customize loaders<!-- --></h2><p>Depending on the scenario, you may need to exclude the file type you need to load from the static asset rules first and then add your own loader or modify it. Refer to the following examples:</p><ul><li><p><a href="https://github.com/umijs/umi/discussions/8218">discussions/8218</a></p></li><li><p><a href="https://github.com/umijs/umi/discussions/8452">discussions/8452</a></p></li></ul><h2 id="how-to-use-css-modules-in-third-party-packages"><a aria-hidden="true" tabindex="-1" href="#how-to-use-css-modules-in-third-party-packages"><span class="icon icon-link"></span></a>How to use css modules in third-party packages<!-- --></h2><ol><li><p>Directly publish the source code of third-party packages&#x27; <!-- --><code>jsx</code> / <!-- --><code>ts</code> / <!-- --><code>tsx</code> to npm, no need to translate to <!-- --><code>js</code>. Umi 4 supports direct use.<!-- --></p></li><li><p>If the third-party package output is <!-- --><code>js</code>, you need to include it for additional processing by babel to support css modules:<!-- --></p></li></ol><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  extraBabelIncludes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;your-pkg-name&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><h2 id="how-to-solve-the-lack-of-hot-updates-in-npm-linked-packages"><a aria-hidden="true" tabindex="-1" href="#how-to-solve-the-lack-of-hot-updates-in-npm-linked-packages"><span class="icon icon-link"></span></a>How to solve the lack of hot updates in npm linked packages<!-- --></h2><p>Umi 4 has <!-- --><code>mfsu</code> enabled by default and ignores changes in <!-- --><code>node_modules</code> by default. Exclude the package from <!-- --><code>mfsu</code> as follows:<!-- --></p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">
</span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  mfsu</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">    exclude</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;package-name&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><h2 id="what-is-the-priority-order-of-config-files-for-different-environments"><a aria-hidden="true" tabindex="-1" href="#what-is-the-priority-order-of-config-files-for-different-environments"><span class="icon icon-link"></span></a>What is the priority order of config files for different environments?<!-- --></h2><p>For the detailed loading priority, see <!-- --><a href="/en-US/docs/guides/env-variables#umi_env">UMI_ENV</a>, and the same applies to <!-- --><code>config/config.ts</code> or <!-- --><code>.umirc.ts</code>.<!-- --></p><h2 id="problems-with-ie-compatibility"><a aria-hidden="true" tabindex="-1" href="#problems-with-ie-compatibility"><span class="icon icon-link"></span></a>Problems with IE compatibility<!-- --></h2><p>Umi 4 is not IE compatible by default in the context of modern browsers.</p><p>If you need to adjust the build for compatibility targets, for older browsers, or for IE, please refer to <!-- --><a href="/en-US/blog/legacy-browser">Legacy Browser Compatibility</a>.<!-- --></p><h2 id="ssr-issues"><a aria-hidden="true" tabindex="-1" href="#ssr-issues"><span class="icon icon-link"></span></a>SSR Issues<!-- --></h2><p>SSR is still an experimental feature and not recommended for production environments. If any issues are encountered, they should be reported on <!-- --><a href="https://github.com/umijs/umi/issues">issues</a>.<!-- --></p><h2 id="vue--vite-issues"><a aria-hidden="true" tabindex="-1" href="#vue--vite-issues"><span class="icon icon-link"></span></a>Vue / Vite Issues<!-- --></h2><p>Umi 4 now supports Vite mode and Vue. There may be edge cases, so report any issues on <!-- --><a href="https://github.com/umijs/umi/issues">issue</a>.<!-- --></p><h2 id="why-does-the-pathname-obtained-from-history-differ-from-the-one-obtained-from-uselocation"><a aria-hidden="true" tabindex="-1" href="#why-does-the-pathname-obtained-from-history-differ-from-the-one-obtained-from-uselocation"><span class="icon icon-link"></span></a>Why does the pathname obtained from <!-- --><code>history</code> differ from the one obtained from <!-- --><code>useLocation</code>?<!-- --></h2><p>This situation occurs when the project is configured with <!-- --><code>base</code>. <!-- --><code>history.location.pathname</code> reflects the browser&#x27;s pathname, which includes the <!-- --><code>base</code>. Route-related hooks, however, return the <!-- --><strong>frontend route</strong> definition&#x27;s pathname, which does not include the <!-- --><code>base</code>. <!-- --><a href="/en-US/docs/guides/routes#location-information">Reference</a>.<!-- --></p><h2 id="how-to-change-the-compression-encoding-format-of-the-output"><a aria-hidden="true" tabindex="-1" href="#how-to-change-the-compression-encoding-format-of-the-output"><span class="icon icon-link"></span></a>How to change the compression encoding format of the output<!-- --></h2><p>By default, the js/css compressor <!-- --><code>esbuild</code> uses <!-- --><code>ascii</code> encoding for compression, which may lead to the encoding of Chinese characters and increase the size of the output.<!-- --></p><p>Adjust the encoding to <!-- --><code>utf8</code> to prevent character conversion:<!-- --></p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  jsMinifierOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> charset</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;utf8&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  cssMinifierOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> charset</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;utf8&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><p>Or switch the compressor to resolve this:</p><div class="dumi-default-source-code"><button type="button" class="dumi-default-source-code-copy"><svg viewBox="64 64 896 896"><path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2 263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path></svg></button><pre class="prism-code language-ts"><div class=""><div class=""><span class="token comment">// .umirc.ts</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  jsMinifier</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;terser&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain">  cssMinifier</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;cssnano&#x27;</span><span class="token plain"></span></div></div><div class=""><div class=""><span class="token plain"></span><span class="token punctuation">}</span></div></div></pre></div><h2 id="how-to-configure-devserver-options"><a aria-hidden="true" tabindex="-1" href="#how-to-configure-devserver-options"><span class="icon icon-link"></span></a>How to configure devServer options<!-- --></h2><p>Umi 4 no longer supports configuring <!-- --><code>devServer</code>, but you can find alternatives as follows:<!-- --></p><ol><li><p>Use the <!-- --><a href="/en-US/docs/api/config#proxy"><code>proxy</code></a> option to set up a proxy, and modify request header information through <!-- --><code>onProxyReq</code>, see <!-- --><a href="https://github.com/umijs/umi/issues/10760#issuecomment-1471158059">#10760</a>.<!-- --></p></li><li><p>Write a <!-- --><a href="/en-US/docs/guides/use-plugins#project-level-plugins">project-level plugin</a> to insert an express middleware to modify requests, see <!-- --><a href="https://github.com/umijs/umi/issues/10060#issuecomment-1471519707">#10060</a>.<!-- --></p></li></ol></div></div><script>$RC("B:2","S:2")</script>